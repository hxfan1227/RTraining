<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>ggplot2 • RTraining</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="ggplot2">
<meta property="og:description" content="RTraining">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">RTraining</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/About_R.html">About R</a>
    </li>
    <li>
      <a href="../articles/Data_Manipulation.html">Data Manipulation</a>
    </li>
    <li>
      <a href="../articles/Data_Transformation.html">Data Transformation</a>
    </li>
    <li>
      <a href="../articles/R%20_Programming.html">R Programming</a>
    </li>
    <li>
      <a href="../articles/R_Basics.html">R Basics</a>
    </li>
    <li>
      <a href="../articles/R_ggplot2.html">ggplot2</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="R_ggplot2_files/accessible-code-block-0.0.1/empty-anchor.js"></script><link href="R_ggplot2_files/anchor-sections-1.0/anchor-sections.css" rel="stylesheet">
<script src="R_ggplot2_files/anchor-sections-1.0/anchor-sections.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>ggplot2</h1>
            
      
      
      <div class="hidden name"><code>R_ggplot2.Rmd</code></div>

    </div>

    
    
<div id="ggplot基本用法" class="section level1">
<h1 class="hasAnchor">
<a href="#ggplot%E5%9F%BA%E6%9C%AC%E7%94%A8%E6%B3%95" class="anchor"></a>ggplot基本用法</h1>
<div id="创建第一个ggplot" class="section level2">
<h2 class="hasAnchor">
<a href="#%E5%88%9B%E5%BB%BA%E7%AC%AC%E4%B8%80%E4%B8%AAggplot" class="anchor"></a>创建第一个<code>ggplot</code>
</h2>
<p>油耗（hwy）与排量之间的关系（displ）是怎样的？</p>
<div class="sourceCode" id="cb1"><pre class="downlit">
<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">mpg</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span>mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">displ</span>, y <span class="op">=</span> <span class="va">hwy</span><span class="op">)</span><span class="op">)</span></pre></div>
<p><img src="R_ggplot2_files/figure-html/unnamed-chunk-2-1.png" width="700" style="display: block; margin: auto;"></p>
</div>
<div id="基本语法和属性" class="section level2">
<h2 class="hasAnchor">
<a href="#%E5%9F%BA%E6%9C%AC%E8%AF%AD%E6%B3%95%E5%92%8C%E5%B1%9E%E6%80%A7" class="anchor"></a>基本语法和属性</h2>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1"></a><span class="kw">ggplot</span>(<span class="dt">data =</span> <span class="op">&lt;</span>DATA<span class="op">&gt;</span>) <span class="op">+</span><span class="st"> </span></span>
<span id="cb2-2"><a href="#cb2-2"></a><span class="st">  </span><span class="er">&lt;</span>GEOM_FUNCTION<span class="op">&gt;</span>(<span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="op">&lt;</span>MAPPINGS<span class="op">&gt;</span>))</span></code></pre></div>
</div>
</div>
<div id="映射图形属性aesthetic-mappings" class="section level1">
<h1 class="hasAnchor">
<a href="#%E6%98%A0%E5%B0%84%E5%9B%BE%E5%BD%A2%E5%B1%9E%E6%80%A7aesthetic-mappings" class="anchor"></a>映射图形属性（Aesthetic mappings）</h1>
<div id="什么是映射" class="section level2">
<h2 class="hasAnchor">
<a href="#%E4%BB%80%E4%B9%88%E6%98%AF%E6%98%A0%E5%B0%84" class="anchor"></a>什么是映射</h2>
<blockquote>
<p>“The greatest value of a picture is when it forces us to notice what we never expected to see.” — John Tukey</p>
</blockquote>
<p><img src="R_ggplot2_files/figure-html/unnamed-chunk-4-1.png" width="48%"></p>
<pre><code>#&gt; `geom_smooth()` using formula 'y ~ x'</code></pre>
<p><img src="R_ggplot2_files/figure-html/unnamed-chunk-4-2.png" width="48%"></p>
<ul>
<li><p>这些离群的红点什么类型的汽车呢？</p></li>
<li><p>为了解决这个问题，我们可以引入第三个变量，并通过把它<em>映射</em>到某一图形属性（<code>aesthetic</code>）</p></li>
<li><p>图形属性包括点的大小、形状、颜色等等。不同的数值可以<em>映射</em>成不同的属性级别（<code>level</code>）</p></li>
</ul>
</div>
<div id="在ggplot2使用映射" class="section level2">
<h2 class="hasAnchor">
<a href="#%E5%9C%A8ggplot2%E4%BD%BF%E7%94%A8%E6%98%A0%E5%B0%84" class="anchor"></a>在<code>ggplot2</code>使用映射</h2>
<ul>
<li>
<code><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot()</a></code>使用<code>mapping</code>参数传递<em>映射</em>关系</li>
<li>
<em>映射</em>关系通过<code><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes()</a></code>函数进行构建，<code><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes()</a></code>是<code>aesthetic</code>的缩写</li>
</ul>
<p><img src="R_ggplot2_files/figure-html/unnamed-chunk-5-1.png" width="700" style="display: block; margin: auto;"></p>
<div class="columns">
<div class="column">
<ul>
<li>回到刚才的问题，如果我们要看不同类别的车辆油耗与排量之间的区别，我们可以将<code>class</code>映射到点的形状（<code>shape</code>）或者颜色（<code>color</code>）上:</li>
</ul>
</div>
<div class="column">
<p><img src="R_ggplot2_files/figure-html/unnamed-chunk-6-1.png" width="700" style="display: block; margin: auto;"><img src="R_ggplot2_files/figure-html/unnamed-chunk-6-2.png" width="700" style="display: block; margin: auto;"></p>
</div>
</div>
</div>
<div id="手动设置图形属性" class="section level2">
<h2 class="hasAnchor">
<a href="#%E6%89%8B%E5%8A%A8%E8%AE%BE%E7%BD%AE%E5%9B%BE%E5%BD%A2%E5%B1%9E%E6%80%A7" class="anchor"></a>手动设置图形属性</h2>
<p><img src="R_ggplot2_files/figure-html/unnamed-chunk-7-1.png" width="50%"><img src="R_ggplot2_files/figure-html/unnamed-chunk-7-2.png" width="50%"></p>
<blockquote>
<ul>
<li>
<code>ggplot2</code>很强大，你把数据丢给他，设置好映射，选择好几何图形，剩下的它都会帮你搞定</li>
<li>当然，我们可以手动设置图形属性</li>
<li>HOW? （Hint：<code><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes()</a></code>）</li>
<li>只要把图形属性挪到<code><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes()</a></code>函数外就行了！</li>
<li><code>ggplot(data = mpg) + geom_point(mapping = aes(x = displ, y = hwy), color = 'red')</code></li>
</ul>
</blockquote>
</div>
<div id="映射总结" class="section level2">
<h2 class="hasAnchor">
<a href="#%E6%98%A0%E5%B0%84%E6%80%BB%E7%BB%93" class="anchor"></a>映射总结</h2>
<ul>
<li>映射是将数据特征表达成几何图形属性的过程</li>
<li>
<code><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot()</a></code>使用<code>mapping</code>参数传递映射关系</li>
<li>映射关系通过<code><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes()</a></code>函数进行构建，<code><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes()</a></code>是<code>aesthetic</code>的缩写</li>
<li>
<code>ggplot2</code>会根据数据自动计算映射的等级（<code>level</code>）</li>
<li>可以手动设置图形属性（把图形属性挪到<code><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes()</a></code>函数外）</li>
</ul>
</div>
<div id="分面facests" class="section level2">
<h2 class="hasAnchor">
<a href="#%E5%88%86%E9%9D%A2facests" class="anchor"></a>分面（Facests）</h2>
<ul>
<li>除了图形属性外，分面也可以很好的展示不同类型的变量</li>
<li>
<code>ggplot</code>中使用<code>facet_*</code>函数来进行分面</li>
<li>如果我们按照<code>class</code>进行分面:</li>
</ul>
<div class="sourceCode" id="cb4"><pre class="downlit">
<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">mpg</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span>mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">displ</span>, y <span class="op">=</span> <span class="va">hwy</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html">facet_wrap</a></span><span class="op">(</span><span class="op">~</span> <span class="va">class</span>, nrow <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></pre></div>
<p><img src="R_ggplot2_files/figure-html/unnamed-chunk-8-1.png" width="700" style="display: block; margin: auto;"></p>
<ul>
<li>同样，我们可以对驱动方式和气缸数量进行分面(<code>facet_gird()</code>)</li>
</ul>
<div class="sourceCode" id="cb5"><pre class="downlit">
<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">mpg</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span>mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">displ</span>, y <span class="op">=</span> <span class="va">hwy</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_grid.html">facet_grid</a></span><span class="op">(</span><span class="va">drv</span> <span class="op">~</span> <span class="va">cyl</span><span class="op">)</span></pre></div>
<p><img src="R_ggplot2_files/figure-html/unnamed-chunk-9-1.png" width="700" style="display: block; margin: auto;"></p>
</div>
</div>
<div id="图形几何对象geometric-objects" class="section level1">
<h1 class="hasAnchor">
<a href="#%E5%9B%BE%E5%BD%A2%E5%87%A0%E4%BD%95%E5%AF%B9%E8%B1%A1geometric-objects" class="anchor"></a>图形几何对象（Geometric objects）</h1>
<div id="什么是几何对象" class="section level2">
<h2 class="hasAnchor">
<a href="#%E4%BB%80%E4%B9%88%E6%98%AF%E5%87%A0%E4%BD%95%E5%AF%B9%E8%B1%A1" class="anchor"></a>什么是几何对象</h2>
<p><img src="R_ggplot2_files/figure-html/unnamed-chunk-10-1.png" width="48%"><img src="R_ggplot2_files/figure-html/unnamed-chunk-10-2.png" width="48%"></p>
<ul>
<li>以上两幅图的x轴相同，y轴也相同，所描述的数据也相同，但是两幅图存在明显差异</li>
<li>每幅图使用了不同的几何对象（Geometric objects）来描述</li>
<li>在<code>ggplot2</code>的语法中，我们可以说这两幅图用了不同的<code>geoms</code>
</li>
</ul>
</div>
<div id="geoms-geom_" class="section level2">
<h2 class="hasAnchor">
<a href="#geoms-geom_" class="anchor"></a><code>Geoms</code> (<code>geom_*</code>)</h2>
<ul>
<li>在<code>ggplot2</code>中，一个<code>geom</code>指的是用来描述数据的一种几何对象</li>
<li>不同的<code>geom</code>就代表了不同类型的图</li>
<li>在<code>ggplot2</code>中替换几何对象十分方便，只需要替换你加到<code><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot()</a></code>的<code>geom</code>函数，比如上图：</li>
</ul>
<div class="sourceCode" id="cb6"><pre class="downlit">
<span class="co"># left</span>
<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">mpg</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span>mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">displ</span>, y <span class="op">=</span> <span class="va">hwy</span><span class="op">)</span><span class="op">)</span>

<span class="co"># right</span>
<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">mpg</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html">geom_smooth</a></span><span class="op">(</span>mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">displ</span>, y <span class="op">=</span> <span class="va">hwy</span><span class="op">)</span><span class="op">)</span></pre></div>
<ul>
<li>
<code>ggplot2</code>自带了40多种<a href="http://rstudio.com/cheatsheets."><code>geoms</code></a>（还记得怎么查看吗，Hint:<code>apropos</code>）</li>
</ul>
<pre><code>#&gt;  [1] "geom_abline"            "geom_area"              "geom_bar"              
#&gt;  [4] "geom_bin2d"             "geom_blank"             "geom_boxplot"          
#&gt;  [7] "geom_col"               "geom_contour"           "geom_contour_filled"   
#&gt; [10] "geom_count"             "geom_crossbar"          "geom_curve"            
#&gt; [13] "geom_density"           "geom_density_2d"        "geom_density_2d_filled"
#&gt; [16] "geom_density2d"         "geom_density2d_filled"  "geom_dotplot"          
#&gt; [19] "geom_errorbar"          "geom_errorbarh"         "geom_freqpoly"         
#&gt; [22] "geom_function"          "geom_hex"               "geom_histogram"        
#&gt; [25] "geom_hline"             "geom_jitter"            "geom_label"            
#&gt; [28] "geom_line"              "geom_linerange"         "geom_map"              
#&gt; [31] "geom_path"              "geom_point"             "geom_pointrange"       
#&gt; [34] "geom_polygon"           "geom_qq"                "geom_qq_line"          
#&gt; [37] "geom_quantile"          "geom_raster"            "geom_rect"             
#&gt; [40] "geom_ribbon"            "geom_rug"               "geom_segment"          
#&gt; [43] "geom_sf"                "geom_sf_label"          "geom_sf_text"          
#&gt; [46] "geom_smooth"            "geom_spoke"             "geom_step"             
#&gt; [49] "geom_text"              "geom_tile"              "geom_violin"           
#&gt; [52] "geom_vline"</code></pre>
<ul>
<li><code><a href="https://rdrr.io/r/utils/apropos.html">apropos('^geom_')</a></code></li>
</ul>
</div>
<div id="geoms-分组" class="section level2">
<h2 class="hasAnchor">
<a href="#geoms-%E5%88%86%E7%BB%84" class="anchor"></a><code>Geoms</code> (分组)</h2>
<p>如果要分组展示不同的数据，怎么办</p>
<ul>
<li>你可以在<code><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes()</a></code>中使用<code>group</code>参数</li>
<li>将<code>group</code>设置为你想要的的分类变量即可</li>
</ul>
<div class="sourceCode" id="cb8"><pre class="downlit">
<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">mpg</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html">geom_smooth</a></span><span class="op">(</span>mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">displ</span>, y <span class="op">=</span> <span class="va">hwy</span>, group <span class="op">=</span> <span class="va">drv</span><span class="op">)</span><span class="op">)</span></pre></div>
<p><img src="R_ggplot2_files/figure-html/unnamed-chunk-13-1.png" width="700" style="display: block; margin: auto;"></p>
</div>
<div id="在ggplot2中展示多个geoms" class="section level2">
<h2 class="hasAnchor">
<a href="#%E5%9C%A8ggplot2%E4%B8%AD%E5%B1%95%E7%A4%BA%E5%A4%9A%E4%B8%AAgeoms" class="anchor"></a>在<code>ggplot2</code>中展示多个<code>geoms</code>
</h2>
<ul>
<li>如果要在一张图中展示多个<code>geoms</code>怎么办？</li>
<li>可以将多个<code>geom_*()</code>函数用<code><a href="https://rdrr.io/r/base/Arithmetic.html">+</a></code>连接</li>
</ul>
<div class="sourceCode" id="cb9"><pre class="downlit">
<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">mpg</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span>mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">displ</span>, y <span class="op">=</span> <span class="va">hwy</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html">geom_smooth</a></span><span class="op">(</span>mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">displ</span>, y <span class="op">=</span> <span class="va">hwy</span><span class="op">)</span><span class="op">)</span></pre></div>
<p><img src="R_ggplot2_files/figure-html/unnamed-chunk-14-1.png" width="700" style="display: block; margin: auto;"></p>
</div>
<div id="mapping继承" class="section level2">
<h2 class="hasAnchor">
<a href="#mapping%E7%BB%A7%E6%89%BF" class="anchor"></a><code>mapping</code>继承</h2>
<ul>
<li>考虑一下刚刚那段代码：</li>
</ul>
<div class="sourceCode" id="cb10"><pre class="downlit">
<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">mpg</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span>mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">displ</span>, y <span class="op">=</span> <span class="va">hwy</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html">geom_smooth</a></span><span class="op">(</span>mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">displ</span>, y <span class="op">=</span> <span class="va">hwy</span><span class="op">)</span><span class="op">)</span></pre></div>
<ul>
<li><p>我们在<code>geom_point</code>和<code>geom_smooth</code>中分别指定了<code>mapping</code>，但是它们实际上是一样的</p></li>
<li><p>为了简化代码，我们可以将<strong>一系列相同的</strong>的<code>mapping</code>传递给<code><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot()</a></code>，而后续增加的<code>geom_*()</code>会继承这些参数，除非你重新指定：</p></li>
</ul>
<div class="sourceCode" id="cb11"><pre class="downlit">
<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">mpg</span>, mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">displ</span>, y <span class="op">=</span> <span class="va">hwy</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>color <span class="op">=</span> <span class="va">class</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html">geom_smooth</a></span><span class="op">(</span><span class="op">)</span></pre></div>
<p><img src="R_ggplot2_files/figure-html/unnamed-chunk-16-1.png" width="70%" style="display: block; margin: auto;"> - 在<code>geom_*()</code>指定的<code>mapping</code>只会影响当前的<code>geom</code>行为</p>
</div>
<div id="data继承" class="section level2">
<h2 class="hasAnchor">
<a href="#data%E7%BB%A7%E6%89%BF" class="anchor"></a><code>data</code>继承</h2>
<ul>
<li>除了<code>mapping</code>参数可以继承外，<code>data</code>也是可以继承的</li>
<li>如果你不指定新的<code>data</code>，所有后续的<code>geom_*()</code>都会继承相同的<code>data</code>
</li>
<li>你可以在不同<code>geom_*()</code>使用不同的<code>data</code>
</li>
<li>在<code>geom_*()</code>指定的<code>data</code>只会影响当前的<code>geom</code>行为</li>
</ul>
<div class="sourceCode" id="cb12"><pre class="downlit">
<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">mpg</span>, mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">displ</span>, y <span class="op">=</span> <span class="va">hwy</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span>mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>color <span class="op">=</span> <span class="va">class</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html">geom_smooth</a></span><span class="op">(</span>data <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">mpg</span>, <span class="va">class</span> <span class="op">==</span> <span class="st">"subcompact"</span><span class="op">)</span>, se <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></pre></div>
<p><img src="R_ggplot2_files/figure-html/unnamed-chunk-17-1.png" width="700" style="display: block; margin: auto;"></p>
</div>
<div id="geoms-总结" class="section level2">
<h2 class="hasAnchor">
<a href="#geoms-%E6%80%BB%E7%BB%93" class="anchor"></a><code>Geoms</code> 总结</h2>
<ul>
<li>在<code>ggplot2</code>中，一个<code>geom</code>指的是用来描述数据的一种几何对象</li>
<li>可以通过设置<code>group</code>参数，在不做映射的情况下分组绘制多个<code>geom</code>
</li>
<li>用<code><a href="https://rdrr.io/r/base/Arithmetic.html">+</a></code>连接连接多个<code>geom_*()</code>函数可以绘制多个几何图形</li>
<li>
<code>geom_*()</code>会继承<code><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot()</a></code>中的<code>data</code>和<code>mapping</code>参数</li>
<li>在<code>geom_*()</code>指定的<code>data</code>和<code>mapping</code>只会影响当前的<code>geom</code>行为</li>
</ul>
</div>
</div>
<div id="统计变换" class="section level1">
<h1 class="hasAnchor">
<a href="#%E7%BB%9F%E8%AE%A1%E5%8F%98%E6%8D%A2" class="anchor"></a>统计变换</h1>
<div id="什么是统计变换" class="section level2">
<h2 class="hasAnchor">
<a href="#%E4%BB%80%E4%B9%88%E6%98%AF%E7%BB%9F%E8%AE%A1%E5%8F%98%E6%8D%A2" class="anchor"></a>什么是统计变换</h2>
<ul>
<li>柱形图(<code><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html">geom_bar()</a></code>)</li>
</ul>
<div class="sourceCode" id="cb13"><pre class="downlit">
<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">diamonds</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html">geom_bar</a></span><span class="op">(</span>mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">cut</span><span class="op">)</span><span class="op">)</span></pre></div>
<p><img src="R_ggplot2_files/figure-html/unnamed-chunk-18-1.png" width="70%" style="display: block; margin: auto;"></p>
<ul>
<li>柱形图和之前的散点图有什么区别？</li>
<li>很多图形，如散点图，展示的数据本身，而有些图形，如柱形图，会计算新的变量并展示：
<ul>
<li>柱形图、直方图等默认会将数据分组（bin）并统计每组内的数据数量</li>
<li>平滑线会用模型拟合你的数据并展示预测数据</li>
<li>箱形会统计数据分布并展示</li>
</ul>
</li>
</ul>
</div>
<div id="stat_" class="section level2">
<h2 class="hasAnchor">
<a href="#stat_" class="anchor"></a><code>stat_*()</code>
</h2>
<ul>
<li>
<code>ggplot2</code>中用来进行统计变换的函数为<code>stat_*()</code>
</li>
<li>下图展示了<code><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html">geom_bar()</a></code>通过<code><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html">stat_count()</a></code>进行统计变换的流程</li>
</ul>
<p><img src="Figures/visualization-stat-bar.png" width="48%" style="display: block; margin: auto;"></p>
<ul>
<li>运行<code><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html">?geom_bar</a></code>来查看其可以计算的统计量</li>
<li>你可以任意使用<code>stat_*()</code>和<code>geom_*()</code>来绘制相同的图形</li>
</ul>
<div class="sourceCode" id="cb14"><pre class="downlit">
<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">diamonds</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html">stat_count</a></span><span class="op">(</span>mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">cut</span><span class="op">)</span><span class="op">)</span></pre></div>
<p><img src="R_ggplot2_files/figure-html/unnamed-chunk-20-1.png" width="48%" style="display: block; margin: auto;"></p>
<ul>
<li>每种<code>geom</code>都有一个默认的<code>stat</code>，每种<code>stat</code>也都对应一个默认的<code>geom</code>
</li>
</ul>
</div>
<div id="改变默认的统计变换" class="section level2 allowframebreaks">
<h2 class="hasAnchor">
<a href="#%E6%94%B9%E5%8F%98%E9%BB%98%E8%AE%A4%E7%9A%84%E7%BB%9F%E8%AE%A1%E5%8F%98%E6%8D%A2" class="anchor"></a>改变默认的统计变换</h2>
<ul>
<li>假设你有如下一组数据：</li>
</ul>
<pre><code>#&gt; # A tibble: 5 x 2
#&gt;   cut        freq
#&gt;   &lt;chr&gt;     &lt;dbl&gt;
#&gt; 1 Fair       1610
#&gt; 2 Good       4906
#&gt; 3 Very Good 12082
#&gt; 4 Premium   13791
#&gt; 5 Ideal     21551</code></pre>
<p><img src="R_ggplot2_files/figure-html/unnamed-chunk-21-1.png" width="48%"><img src="R_ggplot2_files/figure-html/unnamed-chunk-21-2.png" width="48%"></p>
<ul>
<li>如何得到每种类别所占的比例？(<code>prop</code>)</li>
<li><code>vignette("ggplot2-specs")</code></li>
<li><code><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html">?geom_bar</a></code></li>
</ul>
<div class="sourceCode" id="cb16"><pre class="downlit">
<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">diamonds</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html">geom_bar</a></span><span class="op">(</span>mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">cut</span>, y <span class="op">=</span> <span class="va">..prop..</span>, group <span class="op">=</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span></pre></div>
<p><img src="R_ggplot2_files/figure-html/unnamed-chunk-22-1.png" width="700" style="display: block; margin: auto;"></p>
</div>
<div id="更复杂的统计" class="section level2 allowframebreaks">
<h2 class="hasAnchor">
<a href="#%E6%9B%B4%E5%A4%8D%E6%9D%82%E7%9A%84%E7%BB%9F%E8%AE%A1" class="anchor"></a>更复杂的统计</h2>
<ul>
<li>
<code>ggplot2</code>提供了30种统计变换函数：</li>
</ul>
<pre><code>#&gt;  [1] "stat_bin"               "stat_bin_2d"            "stat_bin_hex"          
#&gt;  [4] "stat_bin2d"             "stat_binhex"            "stat_boxplot"          
#&gt;  [7] "stat_contour"           "stat_contour_filled"    "stat_count"            
#&gt; [10] "stat_density"           "stat_density_2d"        "stat_density_2d_filled"
#&gt; [13] "stat_density2d"         "stat_density2d_filled"  "stat_ecdf"             
#&gt; [16] "stat_ellipse"           "stat_function"          "stat_identity"         
#&gt; [19] "stat_qq"                "stat_qq_line"           "stat_quantile"         
#&gt; [22] "stat_sf"                "stat_sf_coordinates"    "stat_smooth"           
#&gt; [25] "stat_spoke"             "stat_sum"               "stat_summary"          
#&gt; [28] "stat_summary_2d"        "stat_summary_bin"       "stat_summary_hex"      
#&gt; [31] "stat_summary2d"         "stat_unique"            "stat_ydensity"</code></pre>
<ul>
<li>
<code><a href="https://ggplot2.tidyverse.org/reference/stat_summary.html">stat_summary()</a></code>描述每个x对应的y特征</li>
</ul>
<div class="sourceCode" id="cb18"><pre class="downlit">
<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">diamonds</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/stat_summary.html">stat_summary</a></span><span class="op">(</span>
    mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">cut</span>, y <span class="op">=</span> <span class="va">depth</span><span class="op">)</span>,
    fun.ymin <span class="op">=</span> <span class="va">min</span>,
    fun.ymax <span class="op">=</span> <span class="va">max</span>,
    fun.y <span class="op">=</span> <span class="va">median</span>
  <span class="op">)</span>
<span class="co">#&gt; Warning: `fun.y` is deprecated. Use `fun` instead.</span>
<span class="co">#&gt; Warning: `fun.ymin` is deprecated. Use `fun.min` instead.</span>
<span class="co">#&gt; Warning: `fun.ymax` is deprecated. Use `fun.max` instead.</span></pre></div>
<p><img src="R_ggplot2_files/figure-html/unnamed-chunk-24-1.png" width="700" style="display: block; margin: auto;"></p>
</div>
<div id="统计变换总结" class="section level2">
<h2 class="hasAnchor">
<a href="#%E7%BB%9F%E8%AE%A1%E5%8F%98%E6%8D%A2%E6%80%BB%E7%BB%93" class="anchor"></a>统计变换总结</h2>
<ul>
<li>
<code>ggplot2</code>中用来进行统计变换的函数为<code>stat_*()</code>
</li>
<li>每种<code>geom</code>都有一个默认的<code>stat</code>，每种<code>stat</code>也都对应一个默认的<code>geom</code>
</li>
<li>
<code>ggplot2</code>提供了30种统计变换函数</li>
<li>你可以任意使用<code>stat_*()</code>和<code>geom_*()</code>来绘制相同的图形</li>
</ul>
</div>
</div>
<div id="图形位置position_" class="section level1">
<h1 class="hasAnchor">
<a href="#%E5%9B%BE%E5%BD%A2%E4%BD%8D%E7%BD%AEposition_" class="anchor"></a>图形位置（<code>position_*</code>）</h1>
<div id="如何调整图形的位置" class="section level2 allowframebreaks">
<h2 class="hasAnchor">
<a href="#%E5%A6%82%E4%BD%95%E8%B0%83%E6%95%B4%E5%9B%BE%E5%BD%A2%E7%9A%84%E4%BD%8D%E7%BD%AE" class="anchor"></a>如何调整图形的位置</h2>
<ul>
<li>如何展示不同clarity的钻石在不同cut中数量？</li>
</ul>
<div class="sourceCode" id="cb19"><pre class="downlit">
<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">diamonds</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html">geom_bar</a></span><span class="op">(</span>mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">cut</span>, fill <span class="op">=</span> <span class="va">clarity</span><span class="op">)</span>, position <span class="op">=</span> <span class="st">'stack'</span><span class="op">)</span></pre></div>
<p><img src="R_ggplot2_files/figure-html/unnamed-chunk-25-1.png" width="700" style="display: block; margin: auto;"></p>
<ul>
<li>如果你不想要堆积（stack）柱状图，你可以尝试以下4种位置参数：
<ul>
<li><code>position = 'fill'</code></li>
<li><code>position = 'dodge'</code></li>
<li><code>position = 'dodge2'</code></li>
<li><code>position = 'identity'</code></li>
</ul>
</li>
</ul>
<p><img src="R_ggplot2_files/figure-html/unnamed-chunk-26-1.png" width="48%"><img src="R_ggplot2_files/figure-html/unnamed-chunk-26-2.png" width="48%"></p>
<p><img src="R_ggplot2_files/figure-html/unnamed-chunk-27-1.png" width="48%"><img src="R_ggplot2_files/figure-html/unnamed-chunk-27-2.png" width="48%"></p>
</div>
<div id="散点图的位置调整" class="section level2 allowframebreaks">
<h2 class="hasAnchor">
<a href="#%E6%95%A3%E7%82%B9%E5%9B%BE%E7%9A%84%E4%BD%8D%E7%BD%AE%E8%B0%83%E6%95%B4" class="anchor"></a>散点图的位置调整</h2>
<ul>
<li>还记得第一张散点图吗？</li>
</ul>
<p><img src="R_ggplot2_files/figure-html/unnamed-chunk-28-1.png" width="700" style="display: block; margin: auto;"></p>
<ul>
<li><p>我们的原始数据有234个，但是上图仅显示了126个点，还有109个点去哪里了</p></li>
<li><p>它们重叠了（overplotted）</p></li>
<li><p>可以采用<code>position = 'jitter'</code>来改善这个问题</p></li>
</ul>
<div class="sourceCode" id="cb20"><pre class="downlit">
<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">mpg</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span>mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">displ</span>, y <span class="op">=</span> <span class="va">hwy</span><span class="op">)</span>, position <span class="op">=</span> <span class="st">'jitter'</span><span class="op">)</span></pre></div>
<p><img src="R_ggplot2_files/figure-html/unnamed-chunk-29-1.png" width="700" style="display: block; margin: auto;"></p>
</div>
<div id="位置调整总结" class="section level2">
<h2 class="hasAnchor">
<a href="#%E4%BD%8D%E7%BD%AE%E8%B0%83%E6%95%B4%E6%80%BB%E7%BB%93" class="anchor"></a>位置调整总结</h2>
<ul>
<li>
<code>ggplot2</code>提供了一系列位置调整的函数</li>
</ul>
<pre><code>#&gt; [1] "position_dodge"       "position_dodge2"      "position_fill"       
#&gt; [4] "position_identity"    "position_jitter"      "position_jitterdodge"
#&gt; [7] "position_nudge"       "position_stack"</code></pre>
<ul>
<li>当你的图形重叠（overplotted）时，可以使用<code>position = 'jitter'</code>来进行调整</li>
</ul>
</div>
</div>
<div id="坐标系统-coord_" class="section level1">
<h1 class="hasAnchor">
<a href="#%E5%9D%90%E6%A0%87%E7%B3%BB%E7%BB%9F-coord_" class="anchor"></a>坐标系统 (<code>coord_*</code>)</h1>
<div id="什么是坐标系统" class="section level2">
<h2 class="hasAnchor">
<a href="#%E4%BB%80%E4%B9%88%E6%98%AF%E5%9D%90%E6%A0%87%E7%B3%BB%E7%BB%9F" class="anchor"></a>什么是坐标系统</h2>
<ul>
<li><p>坐标系统是<code>ggplot2</code>中最为复杂的组件</p></li>
<li><p><code>ggplot2</code>中的坐标系统通过<code>coord_*</code>函数进行控制</p></li>
<li><p><code>ggplot2</code>中提供的坐标系统有：</p></li>
</ul>
<pre><code>#&gt;  [1] "coord_cartesian" "coord_equal"     "coord_fixed"     "coord_flip"     
#&gt;  [5] "coord_map"       "coord_munch"     "coord_polar"     "coord_quickmap" 
#&gt;  [9] "coord_sf"        "coord_trans"</code></pre>
<p><strong>默认的坐标系为笛卡尔坐标系<code><a href="https://ggplot2.tidyverse.org/reference/coord_cartesian.html">coord_cartesian()</a></code></strong></p>
</div>
<div id="coord_flip" class="section level2">
<h2 class="hasAnchor">
<a href="#coord_flip" class="anchor"></a>coord_flip()</h2>
<ul>
<li>
<code><a href="https://ggplot2.tidyverse.org/reference/coord_flip.html">coord_flip()</a></code>用来翻转x和y轴</li>
</ul>
<div class="sourceCode" id="cb23"><pre class="downlit">
<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">mpg</span>, mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">class</span>, y <span class="op">=</span> <span class="va">hwy</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_boxplot.html">geom_boxplot</a></span><span class="op">(</span><span class="op">)</span>
<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">mpg</span>, mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">class</span>, y <span class="op">=</span> <span class="va">hwy</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_boxplot.html">geom_boxplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_flip.html">coord_flip</a></span><span class="op">(</span><span class="op">)</span></pre></div>
<p><img src="R_ggplot2_files/figure-html/unnamed-chunk-33-1.png" width="48%"><img src="R_ggplot2_files/figure-html/unnamed-chunk-33-2.png" width="48%"></p>
</div>
<div id="coord_quickmap" class="section level2">
<h2 class="hasAnchor">
<a href="#coord_quickmap" class="anchor"></a>coord_quickmap()</h2>
<ul>
<li>
<code><a href="https://ggplot2.tidyverse.org/reference/coord_map.html">coord_quickmap()</a></code>可以用来展示空间数据，如地图等，会自动调整x轴和y轴的比例</li>
</ul>
<div class="sourceCode" id="cb24"><pre class="downlit">
<span class="va">nz</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/map_data.html">map_data</a></span><span class="op">(</span><span class="st">"nz"</span><span class="op">)</span>

<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">nz</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span><span class="va">long</span>, <span class="va">lat</span>, group <span class="op">=</span> <span class="va">group</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_polygon.html">geom_polygon</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="st">"white"</span>, colour <span class="op">=</span> <span class="st">"black"</span><span class="op">)</span>

<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">nz</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span><span class="va">long</span>, <span class="va">lat</span>, group <span class="op">=</span> <span class="va">group</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_polygon.html">geom_polygon</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="st">"white"</span>, colour <span class="op">=</span> <span class="st">"black"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_map.html">coord_quickmap</a></span><span class="op">(</span><span class="op">)</span></pre></div>
<p><img src="R_ggplot2_files/figure-html/unnamed-chunk-35-1.png" width="48%"><img src="R_ggplot2_files/figure-html/unnamed-chunk-35-2.png" width="48%"></p>
</div>
<div id="coord_polar" class="section level2">
<h2 class="hasAnchor">
<a href="#coord_polar" class="anchor"></a>coord_polar()</h2>
<ul>
<li>
<code><a href="https://ggplot2.tidyverse.org/reference/coord_polar.html">coord_polar()</a></code>用来画极坐标</li>
</ul>
<div class="sourceCode" id="cb25"><pre class="downlit">
<span class="va">bar</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">diamonds</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html">geom_bar</a></span><span class="op">(</span>
    mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">cut</span>, fill <span class="op">=</span> <span class="va">cut</span><span class="op">)</span>, 
    show.legend <span class="op">=</span> <span class="cn">FALSE</span>,
    width <span class="op">=</span> <span class="fl">1</span>
  <span class="op">)</span> <span class="op">+</span> 
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>aspect.ratio <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="cn">NULL</span>, y <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span>

<span class="va">bar</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_flip.html">coord_flip</a></span><span class="op">(</span><span class="op">)</span>
<span class="va">bar</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_polar.html">coord_polar</a></span><span class="op">(</span><span class="op">)</span></pre></div>
<p><img src="R_ggplot2_files/figure-html/unnamed-chunk-37-1.png" width="48%"><img src="R_ggplot2_files/figure-html/unnamed-chunk-37-2.png" width="48%"></p>
</div>
</div>
<div id="标度系统" class="section level1">
<h1 class="hasAnchor">
<a href="#%E6%A0%87%E5%BA%A6%E7%B3%BB%E7%BB%9F" class="anchor"></a>标度系统</h1>
<div id="什么是标度系统" class="section level2">
<h2 class="hasAnchor">
<a href="#%E4%BB%80%E4%B9%88%E6%98%AF%E6%A0%87%E5%BA%A6%E7%B3%BB%E7%BB%9F" class="anchor"></a>什么是标度系统</h2>
<ul>
<li>标度系统是一组将数据空间转换成几何空间的函数</li>
<li>
<code>ggplot2</code>中提供了一系列标度函数，均以<code>scale_</code>开头</li>
<li>默认的标度函数有：</li>
</ul>
<pre><code>#&gt;  [1] "scale_alpha"             "scale_alpha_binned"     
#&gt;  [3] "scale_alpha_continuous"  "scale_alpha_date"       
#&gt;  [5] "scale_alpha_datetime"    "scale_alpha_discrete"   
#&gt;  [7] "scale_alpha_identity"    "scale_alpha_manual"     
#&gt;  [9] "scale_alpha_ordinal"     "scale_color_binned"     
#&gt; [11] "scale_color_brewer"      "scale_color_continuous" 
#&gt; [13] "scale_color_date"        "scale_color_datetime"   
#&gt; [15] "scale_color_discrete"    "scale_color_distiller"  
#&gt; [17] "scale_color_fermenter"   "scale_color_gradient"   
#&gt; [19] "scale_color_gradient2"   "scale_color_gradientn"  
#&gt; [21] "scale_color_grey"        "scale_color_hue"        
#&gt; [23] "scale_color_identity"    "scale_color_manual"     
#&gt; [25] "scale_color_ordinal"     "scale_color_steps"      
#&gt; [27] "scale_color_steps2"      "scale_color_stepsn"     
#&gt; [29] "scale_color_viridis_c"   "scale_color_viridis_d"  
#&gt; [31] "scale_colour_binned"     "scale_colour_brewer"    
#&gt; [33] "scale_colour_continuous" "scale_colour_date"      
#&gt; [35] "scale_colour_datetime"   "scale_colour_discrete"  
#&gt; [37] "scale_colour_distiller"  "scale_colour_fermenter" 
#&gt; [39] "scale_colour_gradient"   "scale_colour_gradient2" 
#&gt; [41] "scale_colour_gradientn"  "scale_colour_grey"      
#&gt; [43] "scale_colour_hue"        "scale_colour_identity"  
#&gt; [45] "scale_colour_manual"     "scale_colour_ordinal"   
#&gt; [47] "scale_colour_steps"      "scale_colour_steps2"    
#&gt; [49] "scale_colour_stepsn"     "scale_colour_viridis_b"</code></pre>
</div>
<div id="默认标度" class="section level2">
<h2 class="hasAnchor">
<a href="#%E9%BB%98%E8%AE%A4%E6%A0%87%E5%BA%A6" class="anchor"></a>默认标度</h2>
<p>当你写下：</p>
<div class="sourceCode" id="cb27"><pre class="downlit">
<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">mpg</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span><span class="va">displ</span>, <span class="va">hwy</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>colour <span class="op">=</span> <span class="va">class</span><span class="op">)</span><span class="op">)</span></pre></div>
<p>实际上<code>ggplot2</code>会帮你添加一系列默认的标度函数：</p>
<div class="sourceCode" id="cb28"><pre class="downlit">
<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">mpg</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span><span class="va">displ</span>, <span class="va">hwy</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>colour <span class="op">=</span> <span class="va">class</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_x_continuous</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_y_continuous</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_colour_discrete.html">scale_colour_discrete</a></span><span class="op">(</span><span class="op">)</span></pre></div>
</div>
<div id="调整默认标度" class="section level2">
<h2 class="hasAnchor">
<a href="#%E8%B0%83%E6%95%B4%E9%BB%98%E8%AE%A4%E6%A0%87%E5%BA%A6" class="anchor"></a>调整默认标度</h2>
<p>你可以通过改变标度函数中的默认值来改变标度函数，如：</p>
<div class="sourceCode" id="cb29"><pre class="downlit">
<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">mpg</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span><span class="va">displ</span>, <span class="va">hwy</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_x_continuous</a></span><span class="op">(</span><span class="st">"Label 2"</span><span class="op">)</span></pre></div>
<p>你也可以更换使用不同的标度函数，如：</p>
<div class="sourceCode" id="cb30"><pre class="downlit">
<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">mpg</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span><span class="va">displ</span>, <span class="va">hwy</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>colour <span class="op">=</span> <span class="va">class</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_x_sqrt</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_brewer.html">scale_colour_brewer</a></span><span class="op">(</span><span class="op">)</span></pre></div>
</div>
<div id="图例" class="section level2">
<h2 class="hasAnchor">
<a href="#%E5%9B%BE%E4%BE%8B" class="anchor"></a>图例</h2>
<ul>
<li>
<code>ggplot2</code>中图例和坐标轴统称为<strong>guides</strong>
</li>
</ul>
<p><img src="Figures/ggplot2_guides.png" width="80%" style="display: block; margin: auto;"></p>
<ul>
<li>可以采用<code><a href="https://ggplot2.tidyverse.org/reference/guide_legend.html">guide_legend()</a></code>来修改图例的样式和内容</li>
</ul>
<div class="sourceCode" id="cb31"><pre class="downlit">
<span class="va">base</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">mpg</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span><span class="va">drv</span>, fill <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">cyl</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html">geom_bar</a></span><span class="op">(</span><span class="op">)</span> 

<span class="va">base</span>
<span class="va">base</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/guides.html">guides</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/guide_legend.html">guide_legend</a></span><span class="op">(</span>ncol <span class="op">=</span> <span class="fl">2</span><span class="op">)</span><span class="op">)</span>
<span class="va">base</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/guides.html">guides</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/guide_legend.html">guide_legend</a></span><span class="op">(</span>ncol <span class="op">=</span> <span class="fl">2</span>, byrow <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></pre></div>
</div>
<div id="override-aes" class="section level2">
<h2 class="hasAnchor">
<a href="#override-aes" class="anchor"></a><code>override.aes</code>
</h2>
<ul>
<li>当你的图例需要和图中显示不一样的时候，<code>override.aes</code>很有用！</li>
</ul>
<div class="sourceCode" id="cb32"><pre class="downlit">
<span class="va">base</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">mpg</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span><span class="va">displ</span>, <span class="va">hwy</span>, colour <span class="op">=</span> <span class="va">drv</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">4</span>, alpha <span class="op">=</span> <span class="fl">.2</span>, stroke <span class="op">=</span> <span class="fl">0</span><span class="op">)</span>

<span class="va">base</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/guides.html">guides</a></span><span class="op">(</span>colour <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/guide_legend.html">guide_legend</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span>
<span class="va">base</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/guides.html">guides</a></span><span class="op">(</span>colour <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/guide_legend.html">guide_legend</a></span><span class="op">(</span>override.aes <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>alpha <span class="op">=</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></pre></div>
<p><img src="R_ggplot2_files/figure-html/unnamed-chunk-46-1.png" width="45%"><img src="R_ggplot2_files/figure-html/unnamed-chunk-46-2.png" width="45%"></p>
</div>
</div>
<div id="主题" class="section level1">
<h1 class="hasAnchor">
<a href="#%E4%B8%BB%E9%A2%98" class="anchor"></a>主题</h1>
<div id="theme" class="section level2">
<h2 class="hasAnchor">
<a href="#theme" class="anchor"></a><code>theme()</code>
</h2>
<ul>
<li>主题可以用来调整图中的非数据元素（如：标题、标签、字体、背景、图例等等）</li>
<li>
<code>ggplot</code>提供了一系列内置的主题函数</li>
<li>可以使用<code><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme()</a></code>函数来自定义自己的主题</li>
<li>有大量的第三方包提供了精美的配色主题</li>
</ul>
<pre><code>#&gt; function (line, rect, text, title, aspect.ratio, axis.title, 
#&gt;     axis.title.x, axis.title.x.top, axis.title.x.bottom, axis.title.y, 
#&gt;     axis.title.y.left, axis.title.y.right, axis.text, axis.text.x, 
#&gt;     axis.text.x.top, axis.text.x.bottom, axis.text.y, axis.text.y.left, 
#&gt;     axis.text.y.right, axis.ticks, axis.ticks.x, axis.ticks.x.top, 
#&gt;     axis.ticks.x.bottom, axis.ticks.y, axis.ticks.y.left, axis.ticks.y.right, 
#&gt;     axis.ticks.length, axis.ticks.length.x, axis.ticks.length.x.top, 
#&gt;     axis.ticks.length.x.bottom, axis.ticks.length.y, axis.ticks.length.y.left, 
#&gt;     axis.ticks.length.y.right, axis.line, axis.line.x, axis.line.x.top, 
#&gt;     axis.line.x.bottom, axis.line.y, axis.line.y.left, axis.line.y.right, 
#&gt;     legend.background, legend.margin, legend.spacing, legend.spacing.x, 
#&gt;     legend.spacing.y, legend.key, legend.key.size, legend.key.height, 
#&gt;     legend.key.width, legend.text, legend.text.align, legend.title, 
#&gt;     legend.title.align, legend.position, legend.direction, legend.justification, 
#&gt;     legend.box, legend.box.just, legend.box.margin, legend.box.background, 
#&gt;     legend.box.spacing, panel.background, panel.border, panel.spacing, 
#&gt;     panel.spacing.x, panel.spacing.y, panel.grid, panel.grid.major, 
#&gt;     panel.grid.minor, panel.grid.major.x, panel.grid.major.y, 
#&gt;     panel.grid.minor.x, panel.grid.minor.y, panel.ontop, plot.background, 
#&gt;     plot.title, plot.title.position, plot.subtitle, plot.caption, 
#&gt;     plot.caption.position, plot.tag, plot.tag.position, plot.margin, 
#&gt;     strip.background, strip.background.x, strip.background.y, 
#&gt;     strip.placement, strip.text, strip.text.x, strip.text.y, 
#&gt;     strip.switch.pad.grid, strip.switch.pad.wrap, ..., complete = FALSE, 
#&gt;     validate = TRUE) 
#&gt; NULL</code></pre>
</div>
<div id="第三方主题包" class="section level2">
<h2 class="hasAnchor">
<a href="#%E7%AC%AC%E4%B8%89%E6%96%B9%E4%B8%BB%E9%A2%98%E5%8C%85" class="anchor"></a>第三方主题包</h2>
<p><img src="Figures/few-1.png" width="25%"><img src="Figures/calc-1.png" width="25%"><img src="Figures/economist-1.png" width="25%"><img src="Figures/excel1-1.png" width="25%"><img src="Figures/excel2-1.png" width="25%"><img src="Figures/fivethirtyeight-1.png" width="25%"><img src="Figures/gdocs-1.png" width="25%"><img src="Figures/solarized-alt-1.png" width="25%"><img src="Figures/pander-scatterplot-1.png" width="25%"><img src="Figures/paultol-barplot-1.png" width="25%"><img src="Figures/tableau-colorbind10-1.png" width="25%"><img src="Figures/stata-1.png" width="25%"> # 总结</p>
</div>
<div id="图层语法" class="section level2">
<h2 class="hasAnchor">
<a href="#%E5%9B%BE%E5%B1%82%E8%AF%AD%E6%B3%95" class="anchor"></a>图层语法</h2>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1"></a><span class="kw">ggplot</span>(<span class="dt">data =</span> <span class="op">&lt;</span>DATA<span class="op">&gt;</span>) <span class="op">+</span><span class="st"> </span></span>
<span id="cb34-2"><a href="#cb34-2"></a><span class="st">  </span><span class="er">&lt;</span>GEOM_FUNCTION<span class="op">&gt;</span>(</span>
<span id="cb34-3"><a href="#cb34-3"></a>     <span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="op">&lt;</span>MAPPINGS<span class="op">&gt;</span>),</span>
<span id="cb34-4"><a href="#cb34-4"></a>     <span class="dt">stat =</span> <span class="op">&lt;</span>STAT<span class="op">&gt;</span>, </span>
<span id="cb34-5"><a href="#cb34-5"></a>     <span class="dt">position =</span> <span class="op">&lt;</span>POSITION<span class="op">&gt;</span></span>
<span id="cb34-6"><a href="#cb34-6"></a><span class="st">  </span>) <span class="op">+</span></span>
<span id="cb34-7"><a href="#cb34-7"></a><span class="st">  </span><span class="er">&lt;</span>COORDINATE_FUNCTION<span class="op">&gt;</span><span class="st"> </span><span class="op">+</span></span>
<span id="cb34-8"><a href="#cb34-8"></a><span class="st">  </span><span class="er">&lt;</span>FACET_FUNCTION<span class="op">&gt;</span></span></code></pre></div>
<ul>
<li><p>实际上，你只需要提供data，mapping和geom，其他的参数ggplot2都能用它的默认值帮你搞定</p></li>
<li><p>通过数据、几何图形、映射、统计变换、位置调整、坐标系调整以及分面，理论上你可以画出任何你想要的图片</p></li>
</ul>
<p><img src="R_ggplot2_files/figure-html/unnamed-chunk-50-1.png" width="30%"><img src="R_ggplot2_files/figure-html/unnamed-chunk-50-2.png" width="30%"><img src="R_ggplot2_files/figure-html/unnamed-chunk-50-3.png" width="30%"><img src="R_ggplot2_files/figure-html/unnamed-chunk-50-4.png" width="30%"><img src="R_ggplot2_files/figure-html/unnamed-chunk-50-5.png" width="30%"></p>
</div>
</div>
<div id="进阶绘图技巧" class="section level1">
<h1 class="hasAnchor">
<a href="#%E8%BF%9B%E9%98%B6%E7%BB%98%E5%9B%BE%E6%8A%80%E5%B7%A7" class="anchor"></a>进阶绘图技巧</h1>
<div id="patchwork多图组合" class="section level2">
<h2 class="hasAnchor">
<a href="#patchwork%E5%A4%9A%E5%9B%BE%E7%BB%84%E5%90%88" class="anchor"></a>patchwork多图组合</h2>
<p>要在R中实现一页放多个图，一般使用<code>gridExtra</code>包中的<code>grid.arrange</code>函数或者<code>cowplot</code>包中的<code>plot_grid</code>函数，但是近日Thomas Lin Pedersen又出新作，颠覆了在<code>ggplot2</code>乃至基本包中实现一页多图的最佳方案</p>
<p><img src="Figures/patchwork.png" width="80%" style="display: block; margin: auto;"></p>
</div>
<div id="patchwork基本用法" class="section level2">
<h2 class="hasAnchor">
<a href="#patchwork%E5%9F%BA%E6%9C%AC%E7%94%A8%E6%B3%95" class="anchor"></a>patchwork基本用法</h2>
<p><code>patchwork</code>的使用非常简单，只需要将你需要组合的图像用<code><a href="https://rdrr.io/r/base/Arithmetic.html">+</a></code>连接。</p>
<div class="sourceCode" id="cb35"><pre class="downlit">
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="http://ggplot2.tidyverse.org">ggplot2</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://patchwork.data-imaginist.com">patchwork</a></span><span class="op">)</span>

<span class="va">p1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">mtcars</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span><span class="va">mpg</span>, <span class="va">disp</span><span class="op">)</span><span class="op">)</span>
<span class="va">p2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">mtcars</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_boxplot.html">geom_boxplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span><span class="va">gear</span>, <span class="va">disp</span>, group <span class="op">=</span> <span class="va">gear</span><span class="op">)</span><span class="op">)</span>

<span class="va">p1</span> <span class="op">+</span> <span class="va">p2</span></pre></div>
<p><img src="R_ggplot2_files/figure-html/unnamed-chunk-52-1.png" width="60%" style="display: block; margin: auto;"></p>
</div>
<div id="patchwork进阶排版" class="section level2">
<h2 class="hasAnchor">
<a href="#patchwork%E8%BF%9B%E9%98%B6%E6%8E%92%E7%89%88" class="anchor"></a>patchwork进阶排版</h2>
<p><code>patchwork</code>为任意复杂的布局提供了丰富的支持。请看这个非常易读的代码，它将三个图形嵌套在第四个图形之上:</p>
<div class="sourceCode" id="cb36"><pre class="downlit">
<span class="va">p3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">mtcars</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html">geom_smooth</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span><span class="va">disp</span>, <span class="va">qsec</span><span class="op">)</span><span class="op">)</span>
<span class="va">p4</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">mtcars</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html">geom_bar</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span><span class="va">carb</span><span class="op">)</span><span class="op">)</span>

<span class="op">(</span><span class="va">p1</span> <span class="op">|</span> <span class="va">p2</span> <span class="op">|</span> <span class="va">p3</span><span class="op">)</span> <span class="op">/</span>
      <span class="va">p4</span>
<span class="co">#&gt; `geom_smooth()` using method = 'loess' and formula 'y ~ x'</span></pre></div>
<p><img src="R_ggplot2_files/figure-html/unnamed-chunk-53-1.png" width="80%" style="display: block; margin: auto;"></p>
</div>
<div id="patchwork个性化" class="section level2">
<h2 class="hasAnchor">
<a href="#patchwork%E4%B8%AA%E6%80%A7%E5%8C%96" class="anchor"></a>patchwork个性化</h2>
<div id="标题" class="section level3">
<h3 class="hasAnchor">
<a href="#%E6%A0%87%E9%A2%98" class="anchor"></a>标题</h3>
<div class="sourceCode" id="cb37"><pre class="downlit">
<span class="va">patchwork</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="va">p1</span> <span class="op">+</span> <span class="va">p2</span><span class="op">)</span> <span class="op">/</span> <span class="va">p3</span>
<span class="va">patchwork</span> <span class="op">+</span> <span class="fu"><a href="https://patchwork.data-imaginist.com/reference/plot_annotation.html">plot_annotation</a></span><span class="op">(</span>
  title <span class="op">=</span> <span class="st">'The surprising truth about mtcars'</span>,
  subtitle <span class="op">=</span> <span class="st">'These 3 plots will reveal yet-untold secrets about our beloved data-set'</span>,
  caption <span class="op">=</span> <span class="st">'Disclaimer: None of these plots are insightful'</span>
<span class="op">)</span>
<span class="co">#&gt; `geom_smooth()` using method = 'loess' and formula 'y ~ x'</span></pre></div>
<p><img src="R_ggplot2_files/figure-html/unnamed-chunk-54-1.png" width="80%" style="display: block; margin: auto;"></p>
</div>
</div>
<div id="patchwork个性化-1" class="section level2">
<h2 class="hasAnchor">
<a href="#patchwork%E4%B8%AA%E6%80%A7%E5%8C%96-1" class="anchor"></a>patchwork个性化</h2>
<div id="标签" class="section level3">
<h3 class="hasAnchor">
<a href="#%E6%A0%87%E7%AD%BE" class="anchor"></a>标签</h3>
<div class="sourceCode" id="cb38"><pre class="downlit">
<span class="va">patchwork</span> <span class="op">+</span> <span class="fu"><a href="https://patchwork.data-imaginist.com/reference/plot_annotation.html">plot_annotation</a></span><span class="op">(</span>tag_levels <span class="op">=</span> <span class="st">'A'</span><span class="op">)</span>
<span class="co">#&gt; `geom_smooth()` using method = 'loess' and formula 'y ~ x'</span></pre></div>
<p><img src="R_ggplot2_files/figure-html/unnamed-chunk-55-1.png" width="80%" style="display: block; margin: auto;"></p>
</div>
</div>
<div id="patchwork个性化-2" class="section level2">
<h2 class="hasAnchor">
<a href="#patchwork%E4%B8%AA%E6%80%A7%E5%8C%96-2" class="anchor"></a>patchwork个性化</h2>
<div id="主题-1" class="section level3">
<h3 class="hasAnchor">
<a href="#%E4%B8%BB%E9%A2%98-1" class="anchor"></a>主题</h3>
<ul>
<li>和<code>ggplot</code>有一点区别，在使用<code>patchwork</code>时，应该使用<code><a href="https://rdrr.io/r/base/Logic.html">&amp;</a></code>来连接<code><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme()</a></code>函数</li>
</ul>
<div class="sourceCode" id="cb39"><pre class="downlit">
<span class="va">patchwork</span> <span class="op">&amp;</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_bw</a></span><span class="op">(</span><span class="op">)</span>
<span class="co">#&gt; `geom_smooth()` using method = 'loess' and formula 'y ~ x'</span></pre></div>
<p><img src="R_ggplot2_files/figure-html/unnamed-chunk-56-1.png" width="80%" style="display: block; margin: auto;"></p>
</div>
</div>
<div id="控制布局" class="section level2">
<h2 class="hasAnchor">
<a href="#%E6%8E%A7%E5%88%B6%E5%B8%83%E5%B1%80" class="anchor"></a>控制布局</h2>
<div id="增加空位" class="section level3">
<h3 class="hasAnchor">
<a href="#%E5%A2%9E%E5%8A%A0%E7%A9%BA%E4%BD%8D" class="anchor"></a>增加空位</h3>
<div class="sourceCode" id="cb40"><pre class="downlit">
<span class="va">p1</span> <span class="op">+</span> <span class="fu"><a href="https://patchwork.data-imaginist.com/reference/plot_spacer.html">plot_spacer</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> <span class="va">p2</span> <span class="op">+</span> <span class="fu"><a href="https://patchwork.data-imaginist.com/reference/plot_spacer.html">plot_spacer</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> <span class="va">p3</span> <span class="op">+</span> <span class="fu"><a href="https://patchwork.data-imaginist.com/reference/plot_spacer.html">plot_spacer</a></span><span class="op">(</span><span class="op">)</span></pre></div>
<p><img src="R_ggplot2_files/figure-html/unnamed-chunk-58-1.png" width="60%" style="display: block; margin: auto;"></p>
</div>
</div>
<div id="控制布局-1" class="section level2">
<h2 class="hasAnchor">
<a href="#%E6%8E%A7%E5%88%B6%E5%B8%83%E5%B1%80-1" class="anchor"></a>控制布局</h2>
<div id="控制网格" class="section level3">
<h3 class="hasAnchor">
<a href="#%E6%8E%A7%E5%88%B6%E7%BD%91%E6%A0%BC" class="anchor"></a>控制网格</h3>
<ul>
<li>使用<code><a href="https://patchwork.data-imaginist.com/reference/plot_layout.html">plot_layout()</a></code>函数</li>
</ul>
<div class="sourceCode" id="cb41"><pre class="downlit">
<span class="va">p1</span> <span class="op">+</span> <span class="va">p2</span> <span class="op">+</span> <span class="va">p3</span> <span class="op">+</span> <span class="va">p4</span> <span class="op">+</span> 
  <span class="fu"><a href="https://patchwork.data-imaginist.com/reference/plot_layout.html">plot_layout</a></span><span class="op">(</span>widths <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span></pre></div>
<p><img src="R_ggplot2_files/figure-html/unnamed-chunk-59-1.png" width="80%" style="display: block; margin: auto;"></p>
</div>
</div>
<div id="控制图例" class="section level2">
<h2 class="hasAnchor">
<a href="#%E6%8E%A7%E5%88%B6%E5%9B%BE%E4%BE%8B" class="anchor"></a>控制图例</h2>
<div id="使用guides-collect" class="section level3">
<h3 class="hasAnchor">
<a href="#%E4%BD%BF%E7%94%A8guides-collect" class="anchor"></a>使用<code>guides = 'collect'</code>
</h3>
<div class="sourceCode" id="cb42"><pre class="downlit">
<span class="va">p1</span> <span class="op">+</span> <span class="va">p2</span> <span class="op">+</span> <span class="va">p3</span> <span class="op">+</span> <span class="va">p4</span> <span class="op">+</span>
  <span class="fu"><a href="https://patchwork.data-imaginist.com/reference/plot_layout.html">plot_layout</a></span><span class="op">(</span>guides <span class="op">=</span> <span class="st">'collect'</span><span class="op">)</span></pre></div>
<p><img src="R_ggplot2_files/figure-html/unnamed-chunk-60-1.png" width="80%" style="display: block; margin: auto;"></p>
</div>
</div>
<div id="控制图例-1" class="section level2">
<h2 class="hasAnchor">
<a href="#%E6%8E%A7%E5%88%B6%E5%9B%BE%E4%BE%8B-1" class="anchor"></a>控制图例</h2>
<div id="使用guide_area控制图例的位置" class="section level3">
<h3 class="hasAnchor">
<a href="#%E4%BD%BF%E7%94%A8guide_area%E6%8E%A7%E5%88%B6%E5%9B%BE%E4%BE%8B%E7%9A%84%E4%BD%8D%E7%BD%AE" class="anchor"></a>使用<code>guide_area()</code>控制图例的位置</h3>
<div class="sourceCode" id="cb43"><pre class="downlit">
<span class="va">p1</span> <span class="op">+</span> <span class="va">p2</span> <span class="op">+</span> <span class="va">p3</span> <span class="op">+</span> <span class="fu"><a href="https://patchwork.data-imaginist.com/reference/guide_area.html">guide_area</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu"><a href="https://patchwork.data-imaginist.com/reference/plot_layout.html">plot_layout</a></span><span class="op">(</span>guides <span class="op">=</span> <span class="st">'collect'</span><span class="op">)</span></pre></div>
<p><img src="R_ggplot2_files/figure-html/unnamed-chunk-61-1.png" width="80%" style="display: block; margin: auto;"></p>
</div>
</div>
<div id="ggplot-extension" class="section level2">
<h2 class="hasAnchor">
<a href="#ggplot-extension" class="anchor"></a><code>ggplot-extension</code>
</h2>
<ul>
<li><a href="https://github.com/topics/ggplot-extension"><code>ggplot-extension</code></a></li>
<li><a href="https://github.com/thomasp85/gganimate"><code>gganimate</code> (A Grammar of Animated Graphics)</a></li>
<li><a href="https://github.com/hrbrmstr/hrbrthemes"><code>hrbrthemes</code> (Additional Themes)</a></li>
<li><a href="https://github.com/const-ae/ggsignif"><code>ggsignif</code> (Significance Brackets for <code>ggplot2</code>)</a></li>
<li><a href="https://github.com/briatte/ggnetwork"><code>ggnetwork</code> (Geometries to Plot Networks with <code>ggplot2</code>)</a></li>
<li><a href="https://github.com/sinhrks/ggfortify"><code>ggfortify</code> (Data Visualization Tools for Statistical Analysis Results)</a></li>
<li><a href="https://github.com/cran/GGally"><code>GGally</code> (Extension to <code>ggplot2</code>)</a></li>
</ul>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Hongxiang Fan.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
